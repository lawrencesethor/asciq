---
title: "Asymptotic Simultaneous Confidence Intervals for Contrasts of Quantiles"
output: pdf_document
header-includes:
- \usepackage{bbm}
- \usepackage{bm}
- \usepackage{array}
- \usepackage{amssymb}
- \usepackage{amsmath}
- \usepackage{graphicx}
- \usepackage{subcaption}
- \usepackage{float}
- \usepackage[utf8]{inputenc}
- \usepackage[T1]{fontenc}
- \usepackage[english]{babel}
- \usepackage{setspace}
- \usepackage{hanging}
- \usepackage{array}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, message = F, warning = F)
```

\large 

\begin{center}
	\vspace{4 cm}
	{ Gemechis D. Djira*\par}
	\vspace{2 cm}
	{Department of Mathematics and Statistics\\
	South Dakota State University}
\end{center}

\vfill

## Abstract

Skewed data set are ubiquitous in practice. For such data, many hypothesis testing methods have been proposed for comparing medians for independent groups. However, simultaneous confidence intervals have not been previously investigated. In this paper, we develop an asymptotic method for simultaneous comparisons for quantiles. Small sample properties are investigated through simulations. The main goal is to introduce asymptotic simultaneous confidence intervals for multiple comparisons to a control or all pairwise comparisons and application to income data. Also, they will be compared with simultaneous bootstrap confidence intervals such as a rank based method.\par
	
## Keywords:

\vfill

\newpage

# 1 Introduction

The sample mean may not play role as a representative of location parameter when data contain extreme outliers or the distribution of them is skewed or non-normal. In practice, the median may be more useful than the mean because it is not difficult to find skewed distribution such as income distribution. For this reason, medians have been considered in the literature.\par 

Many of the recent papers on using medians to compare distributions has focused on hypothesis testing by approximating the asymptotic distribution of the sample median difference. Examples are rank-based methods (Fung, 1980; Hettmansparger \& McKean, 1998) and the permutation test (Richter \& McCann, 2007) for comparing medians of independent groups. Some bootstrap methods have been also proposed (Davison \& Hinkley, 1997; Wilcox, 2003, 2005). Furthermore, simultaneous multiple comparisons for medians are investigated (Wilcox, 2006; Richter \& McCann, 2013). However, simultaneous confidence intervals have not been previously studied. Confidence intervals are more informative than hypothetical testing for detecting location differences.\par

In this paper, we will introduce asymptotic simultaneous confidence intervals and bootstrap confidence intervals for contrasts for contrasts of quantiles to apply simultaneous multiple comparisons to a control or all pairwise comparisons.


# 2 Multiple contrasts of quantiles

## 2.1 Univariate distribution

Let $\xi_{p,i}$ be the \textit{p}th quantile of a probability function $f_i(\cdot)$ for group $i, i = 1, 2, ..., k,$ and let \textbf{C} be an $m \times k$ matrix containing $m$ contrasts. We are interested in constructing a $100(1 - \alpha)\%$ simultaneous confidence interval for $\textbf{C}\bm{\xi}_{p},$ where $\bm{\xi}_{p} =(\xi_{p,1},\xi_{p,2}, ..., \xi_{p,k})^T$. For example, in multiple comparisons to a control, $m = k - 1,$ and $m = k(k - 1)/2$ for all pairwise comparisons of quantiles. Consider independent samples of size $n_i$ from the probability density function $f_i(\cdot)$. It is well known that \textit{p}th sample quantile  $\hat{\xi}_{p,i} \equiv x_{([n_ip])}$ follows a normal distribution asymptotically,
\[\sqrt{n_i}(\hat{\xi}_{p,i}, \xi_{p,i})\xrightarrow{d}N\Bigg(0, \frac{p(1 - p)}{(f_i(\xi_{p,i}))^2}\Bigg), 0 < p < 1, i = 1, 2, ..., k,\] 
where $f_i(\xi_{p,i})$ is the density value at the \textit{p}th quantile. In other words, 
\[\hat{\xi}_{p,i} \dot{\sim}N\Bigg(\xi_{p,i}, \frac{p(1 - p)}{n_i(f_i(\xi_{p,i}))^2}\Bigg).\]

## 2.2 Multivariate distribution

Let $\bm{\hat{\xi}}_{p} =(\hat{\xi}_{p,1},\hat{\xi}_{p,2}, ..., \hat{\xi}_{p,k})^T$ be a vector of sample quantiles. Then we have 
\[\textbf{C}\bm{\hat{\xi}}_{p}\dot{\sim}N_m(\textbf{C}\bm{\xi}_{p},,\textbf{C}\bm{\Sigma}\textbf{C}^{T}),\]
where the covariance matrix $\bm{\Sigma}$ is a diagonal matrix whose elements are $p(1 - p)/(n_i(f_i(\xi_{p,i}))^2), i = 1, 2, ..., k$. Note that the matrix $\bm{\Sigma}$ involves the density $f_i$ of the underlying probability distribution and that these densities are not necessarily from the same family. We use kernel density estimation (Rosenbatt, 1956; Parzen, 1962) to estimate \textit{f} and  hence $\bm{\Sigma}$. The estimated diagonal elements of $\bm{\Sigma}$ are $p(1 - p)/(n_i(\hat{f}_i(\hat{\xi}_{p,i}))^2)$, where $\hat{f}_i$ is the kernel density estimate of \textit{f} with a Gaussian kernel $K(\bm{\cdot})$, 

$$ \hat{f_{i}}(t) = \frac{1}{n_{i}h}\sum_{j=1}^{n_i}K\Big(\frac{t - x_{ij}}{h}\Big),$$
and $h$ is a bandwidth. We use Silverman's rule of thumb (Silverman, 1986) for the calculation of the bandwidth.\par
Let $\textit{q}_{1-\alpha}$ be the $\alpha$th  equicoordinate quantile of a multivariate normal distribution with mean $\textbf{0}$ and covariance $\textbf{C}\bm{\hat{\Sigma}}\textbf{C}^{T}$, calculated using the Genz and Bretz algorithm (Genz, 1992, 1993; Genz \& Bretz, 2002). The asymptotic $100(1 - \alpha)\%$ simultaneous confidence intervals for $\textbf{c}_j\bm{\xi_p}, j = 1, ..., m,$ are given by 
$$\textbf{c}_j\bm{\xi_p}\pm \textit{q}_{1-\alpha}\sqrt{\textbf{c}_j\bm{\hat{\Sigma}}\textbf{c}_j^{T}},  \quad j = 1, ..., m, $$
where $\textbf{c}_j$ is the \textit{j}th row of contrast matrix \textbf{C}.\par

## 2.3 Bootstrap method

The bootstrap simultaneous confidence interval from the empirical joint distribution is also considered. Let  $\bm{\hat{\delta}} = \textbf{C}\bm{\hat{\xi}}_p$. Generate bootstrap samples from each group and calculate . Then we have $\bm{\hat{\delta}^{^{^{*}}}} = \textbf{C}\bm{\hat{\xi}^{^{^{*}}}}_p$ where $\bm{\hat{\xi}}_{p}^* =(\hat{\xi}_{p,1}^*,\hat{\xi}_{p,2}^*, ..., \hat{\xi}_{p,k}^*)^T$ is the vector of the \textit{p}th sample quantiles based on the bootstrap samples. Rectangular simultaneous confidence interval can be constructed based on other statistics (Basag \textit{et al.}, 1995) or by using percentile bootstrap approach (Mandel \& Betensky, 2008). The simultaneous coverage probabilities  of these methods are compared via simulations  in Section 4.

## 2.4 Time-to-event data

Consider the survival data from asymptotic simultaneous confidence interval. In survival analysis, we are in the distribution of survival times. The survival function $S(t)$ is defined as the probability that a subject survives longer than time $t$. Let $t(p)$ be the $p$th quantile of the distribution and $\hat{S}\big(t(p))$ be the Kaplan Meier estimate (Kaplan \& Meier, 1958) of the survival function at $t(p)$. Also, $\hat{t}(p)$ is the estimated $p$pth quantile and its standard error is given by 
$$\text{se}\big(\hat{t}(p) = \frac{1}{\hat{f}\big(\hat{t}(p))}\text{se}(\hat{S}(\hat{t}(p))),$$
where $\hat{f}$ is an estimate of the probability density function. The standard error of $\hat{S}(\hat{t}(p))$ is found by Greenwood's formula (Greenwood, 1926) while it is not easy to find $\hat{f}$. We use presmoothed kernel density estimation (Lopez-de-Ullibarri \& Jacome, 2013) in survival analysis. For one survival function, an approximate $100(1-\alpha)\%$ confidence interval for $t(p)$ (Collett 2015) is given by 
\[\hat{t}(p) \pm z_{(1 -\alpha/2)} \text{se} \big(\hat{t}(p)) \]
where $z_{(1 -\alpha)}$ is the $\alpha$th quantile of the standard normal distribution.


## 2.4.1 Difference of quantiles

For multiple survival functions, let $\hat{\textbf{t}}(p) = \big(\hat{t}_1(p),\hat{t}_2(p), ..., \hat{t}_k(p))^T$ be a vector of the estimate $p$th quantiles. We propose an asymptotic simultaneous $100(1 - \alpha)\%$ confidence interval for the $j$th contrast to be 
\[c_j\hat{\textbf{t}}\pm q_{1-\alpha}\sqrt{\bm{c_j\hat{\Sigma}c_j^T}},  \qquad  j = 1, ..., m,\] 
where $\hat{\Sigma}$ is a diagonal covariance matrix whose elements are $(\text{se}(\hat{t}_i(p)))^2 \quad i = 1, 2, ..., k.$


## 2.4.2 Ratio of quantiles

In clinical trials, ratios of median survival times for control and intervention groups are also of interest. These ratios have a convenient percent change interpretation. Assuming survival curves are approximately exponential, there is a simple method to obtain an approximate 95\% confidence interval for the ratio $t_i(0.5)/t_j(0.5)$ (Friedman, $et al.$, 2010),
$$\Bigg(\frac{\hat{t}_i(0.5)}{\hat{t}_j(0.5)}e^{-1.96S}, \frac{\hat{t}_i(0.5)}{\hat{t}_j(0.5)}e^{+1.96S}\Bigg)$$
where $S = \sqrt{1/O_i + 1/O_i}$ and $O_i$ is the total number of events for group $i$. However, the exponential distribution is not commonly used for the distribution of survival times. If the assumption is relaxed, it is not simple to find the confidence interval because of the standard error. But confidence interval for the ratio of the $p$th quantiles of survival times can be computed by modifying difference of quantiles. Let $\rho_{p,ij} = t_i(p)/t_j(p)$. Then $t_i(p) - \rho_{p,ij}t_j(p) = 0$. Thus the asymptotic simultaneous $100(1 - \alpha)\%$ confidence interval for the $r$th contrast is 
$$\textbf{c}_r\hat{\textbf{t}}\pm \textit{q}_{1-\alpha}\sqrt{\hat{\textbf{c}}_r\bm{\hat{\Sigma}}\hat{\textbf{c}}_r^{T}},  \quad r = 1, ..., m, $$
where the $i$th and $j$th components of $\textbf{c}_r$ are 1 and $-\rho_{p,ij}$, respectively and $\hat{\rho}_{p,ij} = \hat{t}_i(p)/\hat{t}_j(p)$ in $\hat{\textbf{c}}_r$. Therefore, the asymptotic simultaneous $100(1 - \alpha)\%$ confidence interval for $\rho_{p,ij}$ is given by 
$$\hat{\rho}_{p,ij}\pm \frac{q_{1-\alpha}}{\hat{t}_i(p)}\sqrt{(\text{se}(\hat{t}_i(p)))^2+\hat{\rho}_{p,ij}^2(\text{se}(\hat{t}_i(p)))^2}.$$
From Fieller's theorem (Fieller, 1954), we have the  $100(1 - \alpha)\%$ confidence interval for $\rho_{p,ij}$, 
$$\frac{1}{1 - g}\Big(\hat{\rho}_{p,ij}\pm \frac{q_{1-\alpha}}{\hat{t}_i(p)}\sqrt{(\text{se}(\hat{t}_i(p)))^2(1 - g)+\hat{\rho}_{p,ij}^2(\text{se}(\hat{t}_i(p)))^2}\Big)$$
where $g =q_{1-\alpha}^2(\text{se}(\hat{t}_i(p)))^2/(\hat{t}_i(p))^2$.


# 3 Application to real data

A typical example of skewed data is time-to-event data in survival analysis. Consider survival data about the efficacy of boron neutron capture therapy (Klein \& Moeschberger, 2005). Three groups of rats were studied and there were 10 rats for each group. One group received radiation plus an appropriate concentration of boronophenylalanine (BPA). Suppose that those treated only with radiation is called the Treatment 1 and the last group received\par

Table 1: Estimated survival functions and standard errors for each group in the efficacy of boron neutron capture therapy data. R and E represent the number of rats at risk and the number of events, respectively.
\vspace{1 cm}
\setlength{\extrarowheight}{4pt}
\begin{center}
\begin{tabular}{ c c c c | c c c c | c c c c }
\multicolumn{4}{ c |}{Untreated} & \multicolumn{4}{ c |}{Radiated} & \multicolumn{4}{ c}{Radiated+BPA}  \\ 
 time & R & E & $\hat{S} $ & time & R & E & $\hat{S} $ &time & R & E & $\hat{S} $   \\ 
\hline 
20 & 10 & 1 & 0.9(0.0949) & 26 & 10 & 1 & 0.9(0.0949) & 31 & 10 & 1 & 0.9(0.0949) \\
21 & 9 & 1 & 0.8(0.1265) & 28 & 9 & 1 & 0.8(0.1265) & 32 & 9 & 1 & 0.8(0.1265) \\
23 & 8 & 1 & 0.7(0.1449) & 29 & 8 & 2 & 0.6(0.1549) & 34 & 8 & 1 & 0.7(0.1449) \\
24 & 7 & 2 & 0.5(0.1581) & 30 & 6 & 2 & 0.4(0.1549) & 35 & 7 & 1 & 0.6(0.1549) \\
26 & 5 & 2 & 0.3(0.1449) & 31 & 4 & 2 & 0.2(0.1265) & 36 & 6 & 1 & 0.5(0.1581) \\
27 & 3 & 1 & 0.2(0.1265) & 32 & 2 & 1 & 0.1(0.0949) & 38 & 5 & 2 & 0.3(0.1449) \\
28 & 2 & 1 & 0.1(0.0949) & & & & & & & & \\
30 & 1 & 1 & 0.0 & & & & & & & & \\
\end{tabular}
\end{center}
\vspace{1 cm}

radiation plus BPA is called the Treatment 2. Here, the control is an untreated group. The estimated median survival times are $t_1(0.5) = 30, t_2(0.5) = 38,$ and $t_C(0.5) = 25,$ from the Table 1. Their corresponding standard errors are se$(t_1(0.5)) = 0.7306$, se$(t_2(0.5) = 1.5650)$ and se$t_C(0.5) = 1.2890$ by using Greenwood's formula and the presmoothed density function. \par
For multiple comparisons to a control, the asymptotic simultaneous 95\% confidence intervals for $\delta_{0.5,1C} = t_1(0.5) - t_C(0.5)$ and $\delta_{0.5,2C} = t_2(0.5) - t_C(0.5)$ are $(0.74740, 7.2530)$ and $(7.5386, 16.4614)$, respectively. For the ratio of median survival times, the simultaneous 95\% confidence interval for $\rho_{0.5,1C}$ and $\rho_{0.5,2C}$ are $(1.0154, 1.2923)$
 and $(1.2567, 1.6664)$. Fieller's confidence intervals are $(1.0257, 1.3072)$ for  $\rho_{0.5,1C}$ and $(1.2719, 1.6854)$ for  $\rho_{0.5,2C}$. \par
For all pairwise comparisons, the 95\% confidence intervals for  $\rho_{0.5,12}$,  $\rho_{0.5,1C}$ and  $\rho_{0.5,2C}$ are $(-12.0301, -3.9699)$, $(0.5593, 7.4407)$ and $(7.2811, 16.7189)$, respectively. Also, the confidence interval for  $\rho_{0.5,12}$,  $\rho_{0.5,1C}$ and  $\rho_{0.5,2C}$ are $(0.7013, 0.8777)$, $(1.0058, 1.3019)$ and $(1.2424, 1.6806)$. Fieller's 95\% confidence interval for the ratios are $(0.7079, 0.8857)$, $(1.0195, 1.3191)$ and $(1.2597, 1.7026)$.

<!-- The following begins the first table from the simulations -->

\newpage
Table 2: Coverage probability with multivariate normal and $t(\text{d.f.}=3(n-1))$ equicoordinate quantile function from 10000 replications for \textbf{multiple comparisons to a control} under \textbf{difference} of quantiles

\begin{table}[H]
\setlength{\extrarowheight}{4pt}
\begin{center}
\scalebox{1}{
\begin{tabular}{ c | c c c c | c c c c | c c c }
 n & \multicolumn{2}{c}{$\hat{f}_{MVNq}$} & \multicolumn{2}{c|}{$f_{MVNq}$} & \multicolumn{2}{c}{ $\hat{f}_{MVTq}$} & \multicolumn{2}{c|}{$f_{MVTq}$} & Treatment 1 & Treatment 2 & Control \\
\hline
     &    CP &  AL &    CP &  AL &    CP &  AL &    CP &  AL &   \\
\hline
 10  & 0.943 & 2.6 & 0.965 & 2.5 & 0.957 & 2.7 & 0.974 & 2.6 &   \\
 30  & 0.958 & 1.5 & 0.954 & 1.4 & 0.966 & 1.5 & 0.961 & 1.5 & N(0,1) & N(1,1) & N(2,1) \\
 100 & 0.962 & 0.8 & 0.952 & 0.8 & 0.961 & 0.8 & 0.950 & 0.8 &  \\
 500 & 0.956 & 0.4 & 0.950 & 0.4 & 0.960 & 0.4 & 0.954 & 0.4 &  \\
\hline
 10  & 0.922 &  1.2 & 0.943 &  1.2 & 0.937 &  1.3 & 0.954 &  1.2 &  \\
 30  & 0.940 &  0.7 & 0.946 &  0.7 & 0.944 &  0.7 & 0.954 &  0.7 & Exp(1) & Exp(2) & Exp(3)\\
 100 & 0.943 &  0.4 & 0.950 &  0.4 & 0.942 &  0.4 & 0.948 &  0.4 &  \\
 500 & 0.945 &  0.2 & 0.950 &  0.2 & 0.940 &  0.2 & 0.952 &  0.2 &  \\
\hline
 10  & 0.983 & 4.4 & 0.907 & 3.1 & 0.987 & 4.6 & 0.922 & 3.3 &  \\
 30  & 0.988 & 2.4 & 0.934 & 1.8 & 0.990 & 2.5 & 0.943 & 1.8 & Cauchy(0,1) & Cauchy(1,1) & Cauchy(2,1) \\
 100 & 0.983 & 1.2 & 0.943 & 1.0 & 0.985 & 1.2 & 0.948 & 1.0 &  \\
 500 & 0.928 & 0.4 & 0.951 & 0.4 & 0.928 & 0.4 & 0.948 & 0.4 &  \\
\hline
 10  & 0.968 & 2.9 & 0.881 & 2.0 & 0.977 & 3.0 & 0.900 & 2.1 &  \\
 30  & 0.980 & 1.6 & 0.905 & 1.1 & 0.982 & 1.6 & 0.913 & 1.2 & Laplace(0,1) & Laplace(1,1) & Laplace(2,1) \\
 100 & 0.986 & 0.8 & 0.922 & 0.6 & 0.987 & 0.8 & 0.926 & 0.6 &  \\
 500 & 0.983 & 0.3 & 0.936 & 0.3 & 0.980 & 0.3 & 0.935 & 0.3 &  \\
\hline
 10  & 0.954 & 3.0 & 0.963 & 2.9 & 0.962 & 3.2 & 0.970 & 3.0 &  \\
 30  & 0.960 & 1.7 & 0.955 & 1.6 & 0.963 & 1.8 & 0.955 & 1.7 & GEV(0,1,0) & GEV(1,1,0) & GEV(2,1,0) \\
 100 & 0.957 & 0.9 & 0.952 & 0.9 & 0.961 & 1.0 & 0.953 & 0.9 &  \\
 500 & 0.958 & 0.4 & 0.946 & 0.4 & 0.956 & 0.4 & 0.952 & 0.4 &  \\
\hline
 10  & 0.943 & 2.9 & 0.964 & 2.8 & 0.955 & 3.1 & 0.976 & 3.0 &  \\
 30  & 0.956 & 1.7 & 0.955 & 1.6 & 0.965 & 1.7 & 0.964 & 1.6 & 0.5N(0,1) & 0.5N(1,1) & 0.5N(2,1) \\
 100 & 0.963 & 0.9 & 0.950 & 0.9 & 0.961 & 0.9 & 0.950 & 0.9 & +0.5N(1,1) & +0.5N(2,1) & +0.5N(3,1) \\
 500 & 0.958 & 0.4 & 0.950 & 0.4 & 0.958 & 0.4 & 0.950 & 0.4 &  \\ 
\end{tabular}}
\end{center}
\end{table}
<!-- The second table of results from the simulations. -->

### Key for Tables 2, 3 and 4

\begin{table}[H]
\setlength{\extrarowheight}{3pt}
\scalebox{0.8}{
\begin{tabular}{| l | l |}
\hline
n            & Sample size \\
\hline
$\hat{f}$    & Kernel density estimate at the estimated median, $\hat{\xi}$\\
\hline
$f$          & True density at the true median, $\xi$\\
\hline
$MVNq$       & Equicoordinate quantile from multivariate normal distribution \\
\hline
$MVTq$       & Equicoordinate quantile from multivariate $t$ distribution \\
\hline
CP           & Coverage probability \\
\hline
AL           & Average length of coverage probability\\
\hline
N            & Normal distribution \\
\hline
Exp          & Exponential distribution \\
\hline
GEV          & Generalized extreme value distribution\\
\hline
\end{tabular}}
\end{table}

\newpage



\begin{table}[H]
\caption*{{\large Table 3: Coverage probability with multivariate normal and $t(\text{d.f.}=3(n-1))$ equicoordinate quantile function from 10000 replications for \textbf{all pairwise comparisons} for \textbf{difference} of quantiles.}}
\setlength{\extrarowheight}{4pt}
\begin{center}
\scalebox{1}{
\begin{tabular}{ c | c c c c | c c c c | c c c }
 n & \multicolumn{2}{c}{$\hat{f}_{MVNq}$} & \multicolumn{2}{c|}{$f_{MVNq}$} & \multicolumn{2}{c}{ $\hat{f}_{MVTq}$} & \multicolumn{2}{c|}{$f_{MVTq}$} & Treatment 1 & Treatment 2 & Control \\
\hline
     &    CP &  AL &    CP &  AL &    CP &  AL &    CP &  AL &   \\
\hline
 10  & 0.939 & 2.7 & 0.966 & 2.6 & 0.953 & 2.9 & 0.977 & 2.8 &   \\
 30  & 0.956 & 1.5 & 0.953 & 1.4 & 0.955 & 1.5 & 0.954 & 1.4 &   N(0,1) & N(1,1) & N(2,1) \\
 100 & 0.959 & 0.9 & 0.956 & 0.8 & 0.960 & 0.9 & 0.956 & 0.8 &   \\
 500 & 0.957 & 0.4 & 0.950 & 0.4 & 0.952 & 0.4 & 0.950 & 0.4 &   \\
\hline
 10  & 0.923 &  1.4 & 0.944 &  1.4 & 0.934 &  1.4 & 0.958 &  1.4 &   \\
 30  & 0.934 &  0.7 & 0.945 &  0.7 & 0.946 &  0.7 & 0.951 &  0.7 &   Exp(1) & Exp(2) & Exp(3)\\
 100 & 0.942 &  0.4 & 0.949 &  0.4 & 0.939 &  0.4 & 0.950 &  0.4 &   \\
 500 & 0.943 &  0.2 & 0.953 &  0.2 & 0.943 &  0.2 & 0.947 &  0.2 &   \\
\hline
 10  & 0.982 & 5.3 & 0.893 & 3.3 & 0.987 & 5.6 & 0.914 & 3.5 &   \\
 30  & 0.989 & 2.4 & 0.930 & 1.8 & 0.990 & 2.4 & 0.940 & 1.8 &   Cauchy(0,1) & Cauchy(1,1) & Cauchy(2,1) \\
 100 & 0.988 & 1.3 & 0.946 & 1.0 & 0.986 & 1.3 & 0.946 & 1.0 &   \\
 500 & 0.922 & 0.5 & 0.953 & 0.5 & 0.924 & 0.5 & 0.951 & 0.5 &   \\
\hline
 10  & 0.967 & 3.1 & 0.864 & 2.1 & 0.978 & 3.3 & 0.890 & 2.2 &   \\
 30  & 0.981 & 1.6 & 0.900 & 1.1 & 0.985 & 1.6 & 0.906 & 1.1 &   Laplace(0,1) & Laplace(1,1) & Laplace(2,1) \\
 100 & 0.983 & 0.9 & 0.920 & 0.7 & 0.984 & 0.9 & 0.925 & 0.7 &   \\
 500 & 0.983 & 0.4 & 0.935 & 0.3 & 0.982 & 0.4 & 0.939 & 0.3 &   \\
\hline
 10  & 0.942 & 3.2 & 0.961 & 3.0 & 0.957 & 3.4 & 0.968 & 3.2 &   \\
 30  & 0.958 & 1.7 & 0.946 & 1.6 & 0.961 & 1.7 & 0.953 & 1.6 &   GEV(0,1,0) & GEV(1,1,0) & GEV(2,1,0) \\
 100 & 0.963 & 1.0 & 0.952 & 1.0 & 0.967 & 1.0 & 0.950 & 1.0 &   \\
 500 & 0.957 & 0.4 & 0.948 & 0.4 & 0.959 & 0.4 & 0.951 & 0.4 &   \\
\hline
 10  & 0.936 & 3.1 & 0.966 & 3.0 & 0.952 & 3.2 & 0.980 & 3.1 &   \\
 30  & 0.956 & 1.7 & 0.950 & 1.6 & 0.960 & 1.7 & 0.956 & 1.6 &   0.5N(0,1) & 0.5N(1,1) & 0.5N(2,1) \\
 100 & 0.958 & 1.0 & 0.952 & 0.9 & 0.958 & 1.0 & 0.954 & 0.9 &   +0.5N(1,1) & +0.5N(2,1) & +0.5N(3,1) \\
 500 & 0.955 & 0.4 & 0.950 & 0.4 & 0.956 & 0.4 & 0.949 & 0.4 &   \\ 
\end{tabular}}
\end{center}
\end{table}





\newpage
Table 4: Coverage probability with multivariate normal and $t(\text{d.f.}=3(n-1))$ equicoordinate quantile function from 10000 replications for \textbf{multiple comparisons to a control} under \textbf{ratio} of quantiles.

\begin{table}[H]
\setlength{\extrarowheight}{4pt}
\begin{center}
\scalebox{1}{
\begin{tabular}{ c | c c c c | c c c c | c c c }
 n & \multicolumn{2}{c}{$\hat{f}_{MVNq}$} & \multicolumn{2}{c|}{$f_{MVNq}$} & \multicolumn{2}{c}{ $\hat{f}_{MVTq}$} & \multicolumn{2}{c|}{$f_{MVTq}$} & Treatment 1 & Treatment 2 & Control \\
\hline
     &    CP &  AL &    CP &  AL &    CP &  AL &    CP &  AL &   \\
\hline
 10  & 0.931 & 1.1 & 0.976 & 1.0 & 0.944 & 1.2 & 0.982 & 1.1 &  \\
 30  & 0.949 & 0.5 & 0.954 & 0.5 & 0.955 & 0.5 & 0.958 & 0.5 &  N(0,1) & N(1,1) & N(2,1) \\
 100 & 0.957 & 0.3 & 0.954 & 0.3 & 0.957 & 0.3 & 0.951 & 0.3 &  \\
 500 & 0.953 & 0.1 & 0.948 & 0.1 & 0.953 & 0.1 & 0.945 & 0.1 &  \\
\hline
 10  & 0.878 &  8.5 & 0.934 & 11.5 & 0.888 &  9.1 & 0.942 & 10.6 &  \\
 30  & 0.911 &  3.7 & 0.941 &  3.9 & 0.910 &  3.7 & 0.940 &  4.0 &  Exp(1) & Exp(2) & Exp(3)\\
 100 & 0.935 &  2.0 & 0.950 &  2.1 & 0.932 &  2.0 & 0.955 &  2.1 &  \\
 500 & 0.943 &  0.9 & 0.954 &  0.9 & 0.944 &  0.9 & 0.955 &  0.9 &  \\
\hline
 10  & 0.972 & 3.3 & 0.929 & 1.7 & 0.981 & 3.8 & 0.937 & 1.8 &  \\
 30  & 0.986 & 0.9 & 0.939 & 0.6 & 0.988 & 0.9 & 0.945 & 0.7 &  Cauchy(0,1) & Cauchy(1,1) & Cauchy(2,1) \\
 100 & 0.982 & 0.5 & 0.944 & 0.4 & 0.982 & 0.5 & 0.947 & 0.4 &  \\
 500 & 0.891 & 0.2 & 0.943 & 0.2 & 0.896 & 0.2 & 0.944 & 0.2 &  \\
\hline
 10  & 0.962 & 2.1 & 0.887 & 0.8 & 0.973 & 1.5 & 0.914 & 0.9 &  \\
 30  & 0.979 & 0.6 & 0.900 & 0.4 & 0.980 & 0.6 & 0.907 & 0.4 &  Laplace(0,1) & Laplace(1,1) & Laplace(2,1) \\
 100 & 0.981 & 0.3 & 0.920 & 0.2 & 0.982 & 0.3 & 0.920 & 0.2 &  \\
 500 & 0.979 & 0.1 & 0.931 & 0.1 & 0.979 & 0.1 & 0.936 & 0.1 &  \\
\hline
 10  & 0.926 & 1.1 & 0.972 & 1.0 & 0.940 & 1.2 & 0.986 & 1.1 &  \\
 30  & 0.947 & 0.5 & 0.957 & 0.5 & 0.947 & 0.5 & 0.956 & 0.5 &  GEV(0,1,0) & GEV(1,1,0) & GEV(2,1,0) \\
 100 & 0.951 & 0.3 & 0.953 & 0.3 & 0.954 & 0.3 & 0.955 & 0.3 &  \\
 500 & 0.953 & 0.1 & 0.945 & 0.1 & 0.954 & 0.1 & 0.950 & 0.1 &  \\
\hline
 10  & 0.934 & 1.0 & 0.973 & 0.9 & 0.948 & 1.1 & 0.981 & 1.0 &  \\
 30  & 0.950 & 0.5 & 0.956 & 0.5 & 0.957 & 0.5 & 0.955 & 0.5 &  0.5N(0,1) & 0.5N(1,1) & 0.5N(2,1) \\
 100 & 0.950 & 0.3 & 0.951 & 0.3 & 0.956 & 0.3 & 0.953 & 0.3 &  +0.5N(1,1) & +0.5N(2,1) & +0.5N(3,1) \\
 500 & 0.952 & 0.1 & 0.948 & 0.1 & 0.953 & 0.1 & 0.946 & 0.1 &  \\ 
\end{tabular}}
\end{center}
\end{table}


\newpage
![In the first row, true density of Cauchy(0,1) and estimated densities are shown by sample size. In the second row, from 10000 replications, histograms of $\hat{f}(\hat{\xi})$ from Cauchy(0,1) are shown and the vertical dotted line represent $f(\xi)$.](cG.png){width=95%}

The first row from figure 1 shows that the true density of the cauchy distribution with mean 0 and variance 1 is under estimated by the kernel density estimation used especially for smaller sample sizes. This shown by the dotted lines (kernel density estimate) superimposed on the continuous lines (true density). Hence, the variance, $\sigma^2$, is inflated and hence gives a rather more conservative covarage probability as seen under the cauchy row under $\hat{f}_{MVNq}$ and $\hat{f}_{MVTq}$ in the table 2, 3 and 4. This is true because the density estimate is in the denominator of the variance formula 
$$\sigma_i^2 =\frac{1}{4n_i(f_i(\xi_i))^2}$$

This underestimation is also seen for the second row of figures. The averages of the histograms from 10000 replications of kernel density estimate at the estimated median, $\hat{f}(\hat{\xi})$, is found to be at a value lesser than the true density at the true median $f(\xi)$. The difference is wider when the sample size is small and approaches $f(\xi)$ as the n increases.





![True density of Laplace(0,1) and estimated densities are shown. From 10000 replications, histograms of $\hat{f}(\hat{\xi})$ from Laplace(0,1) are shown and the vertical dotted lines represents $f(\xi)$.](lG.png){width=95%}


The first row from figure 2 shows that the true density of the laplace distribution with mean 0 and variance 1 is under estimated by the kernel density estimation used especially for smaller sample sizes. This shown by the dotted lines (kernel density estimate) superimposed on the continuous lines (true density). Hence, the variance, $\sigma^2$, is inflated and hence gives a rather more conservative covarage probability as seen under the cauchy row under $\hat{f}_{MVNq}$ and $\hat{f}_{MVTq}$ in the table 2, 3 and 4. This is true because the density estimate is in the denominator of the variance formula 
$$\sigma_i^2 =\frac{1}{4n_i(f_i(\xi_i))^2}$$

This underestimation is also seen for the second row in the figure 2. The averages of the histograms from 10000 replications of kernel density estimate at the estimated median, $\hat{f}(\hat{\xi})$, is found to be at a value lesser than the true density at the true median $f(\xi)$. The difference is wider when the sample size is small and becomes more and more smaller as the n increases.

In Figure 2, kernel density estimation cannot reach the mode because estimated functions are fitted well but not for the mode. Note that the kernel density estimation is highly dependent on the bandwidth. Silverman's rule of thumb used for the simulations, works well when data are normally distributed, it is commonly used and is default in density. However, it is sensitive to outliers. The method developed by Sheather and Jones (Sheather \& Jones, 1991) is recommended as being most reliable in terms of overall performance (Jones $et al.$, 1996).\par

\newpage

Table 5: Coverage probability for bootstrap confidence intervals with $B = 5000$ from 10000 replications for multiple comparisons to a control and all pairwise comparisons when $k = 3.$

\begin{table}[H]
\setlength{\extrarowheight}{4pt}
\begin{center}
\scalebox{1}{
\begin{tabular}{ c | c c | c c | c }
  & m = 2 & m = 3 &  &  &  \\ 
\hline
 n & rank-based & percentile & rank-based & percentile & Groups \\
\hline
 10 &  &  &  &  &  \\
 30 &  &  &  &  & Group $i$: N($i$ - 1, 1) \\
 100 &  &  &  &  &  \\
 500 &  &  &  &  &  \\
\hline
 10 &  &  &  &  &  \\
 30 &  &  &  &  & Group $i$:Exp($i$)\\
 100 &  &  &  &  &  \\
 500 &  &  &  &  &  \\
\hline
 10 &  &  &  &  &  \\
 30 &  &  &  &  & Group $i$:Cauchy($i$ - 1, 1) \\
 100 &  &  &  &  &  \\
 500 &  &  &  &  &  \\
\hline
 10 &  &  &  &  &  \\
 30 &  &  &  &  & Group $i$: Laplace($i$ - 1, 1) \\
 100 &  &  &  &  &  \\
 500 &  &  &  &  &  \\
\hline
 10 &  &  &  &  &  \\
 30 &  &  &  &  & Group $i$: GEV($i$ - 1, 1, 0) \\
 100 &  &  &  &  &  \\
 500 &  &  &  &  &  \\
\hline
 10 &  &  &  &  & Group $i$: \\
 30 &  &  &  &  & 0.5 N($i$ - 1, 1) \\
 100 &  &  &  &  & + 0.5 N($i$, 1) \\
 500 &  &  &  &  &  \\ 
\end{tabular}}
\end{center}
\end{table}

\newpage

# 4 Simulation

In simulation study, we focus the asymptotic simultaneous confidence interval for medians, Let $\xi$ be the median. Several distributions of theoretical interest are considered for this simulation. Such distributions are the normal, exponential and mixture of two normal distributions. We also consider Cauchy($\mu,\sigma$), Laplace($\mu,\sigma$) and generalized extreme value GEV($\mu,\sigma, \gamma$) distributions, where $\mu$ is a location parameter, $\sigma$ is a scale parameter and $\gamma$ is a shape parameter. Assume that the sample size of $k$ groups is equal. The nominal simultaneous coverage is set to $1 - \alpha = 0.95$. We use the function density in R for the density estimation. Suppose $k= 3$. Then $m = 2$ for multiple comparisons to a control or $m= 3$ for all pairwise comparisons. Let $\delta_i = \xi_i - \xi_k$, where $\xi$ is the median of the $i$th treatment, $i= 1,2$ and $\xi_k$ is the median of the control. Then the joint distribution of $\bm{\hat{\delta}} = (\hat{\delta}_1, \hat{\delta}_2)^T$  is given by 

$$\bm{\hat{\delta}} = \bm{C\hat{\xi}} \dot{\sim } N_2 \big(\bm{\delta, \textbf{C}\Sigma \textbf{C}}^T\big),$$

where

\[\textbf{C} = \left( {\begin{array}{ccc}
   1 & 0 & -1  \\
   0 & 1 & -1  \\
  \end{array} } \right), \bm{\hat{\xi}}=(\hat{\xi}_1,\hat{\xi}_2,\hat{\xi}_3)^T,  
  \textbf{C}\bm{\xi} = \left( {\begin{array}{c}
   \delta_1   \\
   \delta_2  \\
  \end{array} } \right) ,  
  \textbf{C}\bm{\Sigma}\textbf{C}^T = \left( {\begin{array}{cc}
   \sigma_1^2+\sigma_3^2 & \sigma_3^2   \\
   \sigma_3^2 & \sigma_2^2+\sigma_3^2   \\
  \end{array} } \right)\]
  
and $\sigma_i^2 =\frac{1}{4n_i(f_i(\xi_i))^2}, i = 0, 1, 2.$ For pairwise comparisons, let $\delta_{ij} = \xi_i - \xi_j, i < j$. Then the joint distribution of $\bm{\hat{\xi}}=(\hat{\xi}_{12},\hat{\xi}_{13},\hat{\xi}_{23})^T$ is given by 

\[\bm{\hat{\delta}} = \bm{C\hat{\xi}} \dot{\sim } N_3 \big(\bm{\delta, \textbf{C}\Sigma \textbf{C}}^T\big)\] 

where 

\[\textbf{C} = \left( {\begin{array}{ccc}
   1 & -1 & 0  \\
   1 & 0 & -1  \\
   0 & 1 & -1
  \end{array} } \right), 
  \textbf{C}\bm{\xi} = \left( {\begin{array}{c}
   \delta_{12}  \\
   \delta_{13}  \\
   \delta_{23}  \\
  \end{array} } \right) ,  
  \textbf{C}\bm{\Sigma}\textbf{C}^T = \left( {\begin{array}{ccc}
   \sigma_1^2+\sigma_2^2 & \sigma_1^2 & \sigma_2^2  \\
   \sigma_1^2 & \sigma_1^2+\sigma_3^2 & \sigma_3^2  \\
   \sigma_2^2 & \sigma_3^2 & \sigma_2^2+ \sigma_3^2
  \end{array} } \right)\]

\vspace{1 cm}

By using the equicoordinate quantile function (Genz $et al.$, 2016), the simulation results with kernel density estimation $\hat{f}$ at the estimated median $\hat{\xi}$ and true density function $f$ at the true median $\xi$ are shown in Table 2 for $m = 2$ and Table 3 for $m = 3$. Also, Table 4 displays the results for multiple comparisons to a control under ratio of medians. 

From the tables 1, the average length (AL) reduces as the sample size increase. AL for multivariate $t$ quantile ($MVTq$) is on the average wider or equal to that of the multivariate normal quantile ($MVNq$) irrespective of whether the density is density is the true density or not. The coverage probability for $MVTq$ is on the average wider than that of $MVNq$. For a given quantile, either $MVNq$ or $MVTq$, the $\hat{f}$ at the estimated median $\hat{\xi}$ has a slightly smaller coverage probability on the average compared to thetrue density function $f$ at the true median $\xi$.

From the three tables of the simulation results, it is observed that asymptotic simultaneous confidence intervals are somewhat conservative. One possible reason is that the density is underestimated in Figure 1  for the standard Cauchy distribution and Figure 2 for the standard Laplace distribution. Common nonparametric estimators of a probability density function show bad performance for heavy-tailed distributions (Maiboroda \& Markovich, 2004). 


The results of bootstrap confidence intervals based on order statistics (Schaarschmidt $et al.$, 2016) and percentile bootstrap confidence intervals are shown for multiple comparisons to a control and all pairwise comparisons with $k = 3$ in Table 5.


# Conclusion

In general, the sample mean is better than the sample median as a representative of a location parameter in case of large sample size because the sample mean is asymptotically more efficient than the sample median. Thus sample mean is usually preferred over sample median.


\newpage

# Reference 

\begin{hangparas}{2em}{1} % first argument determines amount of haning indentation
Besag, J., Green, P., Higdon, D., \& Mengersen, K. (1995). Bayesian computation and 
 stochastic systems. \textit{Statistical Science}, 3-41.\\

Collett, D. (2015). \textit{Modelling survival data in medical research.} CRC press.\\

Davison, A. C., \& Hinkley, D. V. (1997). \textit{Bootstrap methods and their application.} Campbridge university press.\\

Fieller, E. C. (1954). Some problems in interval estimation. \textit{Journal of the Royal Statistical Society. Series B,} 175-185.\\

Fung, K. Y. (1980). Small sample behaviour of some nonparametric multi-sample location tests in the presence of dispersion differences. \textit{Statistic Neerlandica,} 34(4), 189-196.\\

Friedman, L. M., Furberg, C., DeMets, D. L. (2010). \textit{Fundamentals of clinical trials.} Springer.\\

Genz, A. (1992). Numerical computation of multivariate normal probabilities. \textit{Journal of  Computational and Graphical Statistics,} 1(2), 141-149.\\

Genz, A. (1993). Comparison of methods for the computation of multivariate normal probabilities. \textit{Computing Science and Statistics,} 25, 400-405.\\

Genz, A., \& Bretz, F. (2002). Comparison of methods for the computation of multivariate t probabilities. \textit{Journal of Computional and Graphical Statistics,} 11(4), 950-971.\\

Genz, A., Bretz, F., Miwa, T., Mi, X., Leisch, F., Scheipl, F., Bornkamp, B., Maechker, M., \& Hothorn, T. (2016). mvtnorm: Multivariate normal and t distributions. R package version 1.0-5.\\

Greenwood, M. (1926). The natural duration of cancer. \textit{Report of Public Health and Medical Subjects}, 33, 1-26\\

Hettmansperger, T. P., \& McKean, J. W. (1998). \textit{Robust Nonparametric Statistical Methods.} Arnold.\\

Jones, M., C., Marron, J.S., \& Sheather, S.J. (1996). A brief survey of bandwidth selection for density estimation. \textit{Journal of the American Statistical Association,} 91(433), 401-407.\\

Kaplan, E. L., \& Meier, P. (1958). Nonparametric estimation from incomplete observations. \textit{Journal of the American statistical association,} 53(282), 457-481.\\

Klein, J. P., \& Moeschberger, M. L. (2005). \textit{Survival analysis: techiques for censored and truncated data.} Springer.\\

Lopez-de-Ullibarri, I \& Jacome, M. A. (2013). survPresmooth: an R package for presmoothed estimation in survival analysis. \textit{Journal of Statistical Software,} 54(11), 1-26.\\

Maiboroda, R. E., \& Markovich, N. M. (2004). Estimation of heavy-tailed probability density function with application to Web data. \textit{Computational Statistics,} 19(4), 58-592.\\

Mandel, M., \& Betensky, R. A. (2008). Simultaneous confidence intervals based on the percentile bootstrap approach. \textit{Computational Statistics and Data Analysis,} 52(4), 2154-2165.\\

Parzen, E. (1962). On estimation of a probability density function and mode. \textit{The Annals of Mathematical Statistics,} 1065-1076.\\

Rosenblatt, M. (1956). Remarks on some nonparametric estimates of a density function. \textit{The Annals of Mathematical Statistics,} 27(3), 832-837.\\

Richter, S. J., \& McCann, M. H. (2007). Multiple comparison of medians using permutation tests. \textit{Journal of Modern Applied Statistical Methods,} 6(2), 399-412.\\

Richter, S. J., \& McCann, M. H. (2013). Simultaneous multiple comparions of medians using permutation tests. \textit{Statistics and Probability Letters,} 83(4), 1167-1173.\\

Schaarschmidt, F., Gerhard, D., \& Sill, M. (2016). MCPAN: Multiple Comparisons Using Normal Approximation. R package version 1.1-20.\\

Sheather, S. J., \& Jones, M. C. (1991). A reliable data-based bandwidth selection method for kernel density estimation. \textit{Journal of the Royal Statistical Society. Series B,} 683-690.\\

Silverman, B. W. (1986). \textit{Density Estimation for Statistics and Data Analysis.} CRC press.\\

Wilcox, R. R. (2003). \textit{Applying Contemporary Statistical Techniques.} Elsevier.\\

Wilcox, R. R. (2005). \textit{Introduction to Robust Estimation and Hypothesis Testing.} Academic Press.\\

Wilcox, R. R. (2006). Comparing medians. \textit{Computational Statistics and Data Analysis,} 51(3),  1934-1943.\\

Yee, T. W. (2015). VGAM: Vector Generalized Linear and Addictive Models. R package version 1.0-0.
\end{hangparas}






